# Description: Small build system with a focus on speed
# URL:         https://ninja-build.org/

name=ninja
version=1.12.1
release=1
source=$name-$version.tar.gz::https://github.com/ninja-build/ninja/archive/refs/tags/v$version.tar.gz

build() {
	# This intentionally does not install to PATH, because we only want to
	# use samurai for pkgsrc*.
	CXXFLAGS="$CXXFLAGS -O2 -flto=auto -DNDEBUG"
	cmake -S $name-$version -B build -G Ninja       \
		-D CMAKE_BUILD_TYPE=None                \
		-D CMAKE_INSTALL_PREFIX=/usr/lib/ninja  \
		-D CMAKE_INSTALL_BINDIR=/usr/lib/ninja  \
		-D BUILD_TESTING=OFF                    \

	ninja -C build -j ${JOBS:-1} -v
	DESTDIR=$PKG ninja -C build install
}
