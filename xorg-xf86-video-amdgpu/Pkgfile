# Description: Xorg driver for AMD Radeon GPUs using the amdgpu kernel driver
# URL:         https://gitlab.freedesktop.org/xorg/driver/xf86-video-amdgpu
# Depends on:  xorg-server

name=xorg-xf86-video-amdgpu
version=25.0.0
release=1
source=https://www.x.org/archive/individual/driver/${name#*-}-$version.tar.xz

build() {
	# -D udev=enabled: Enable libudev support
	# -D glamor=enabled: Enable glamor acceleration
	meson setup build xf86-video-amdgpu-$version  \
		--prefix=/usr                         \
		--buildtype=plain                     \
		--wrap-mode=nodownload                \
		-D b_lto=true                         \
		-D b_pie=true                         \
		-D udev=enabled                       \
		-D glamor=enabled                     \

	ninja -C build -j ${JOBS:-1} -v
	DESTDIR=$PKG ninja -C build install
}
