# Description: Handle keyboard descriptions
# URL:         https://xkbcommon.org/
# Depends on:  xkeyboard-config
# Optional:    wayland-protocols

name=libxkbcommon
version=1.12.0
release=1
source=https://github.com/xkbcommon/$name/archive/xkbcommon-$version.tar.gz

build() {
	if pkgman isinst wayland-protocols >/dev/null 2>&1; then
		_meson_flags="-D enable-wayland=true  -D enable-x11=false"
	else
		_meson_flags="-D enable-wayland=false -D enable-x11=true"
	fi

	meson setup build $name-xkbcommon-$version \
		--prefix=/usr \
		--libexecdir=/usr/lib \
		--wrap-mode=nodownload \
		-D b_lto=true \
		-D b_pie=true \
		-D enable-docs=false \
		$_meson_flags \

	ninja -C build -j ${JOBS:-1} -v
	DESTDIR=$PKG ninja -C build install
}
